<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>Arch Linux - Surface Book 3</title>
<link rel=stylesheet href=/css/style.css></head><body><header>=========================<br>== <a href=https://julianyap.com/>Wilderness Downtown</a> ==<br>=========================<div style=float:right></div><br><p><nav><a href=/><b>Start</b></a>.
<a href=/posts><b>Posts</b></a>.
<a href=/pages><b>Pages</b></a>.
<a href=/about><b>About</b></a>.
<a href=/index.xml><b>RSS</b></a>.</nav></p></header><main><article><h1>Arch Linux - Surface Book 3</h1><b><time>2024-04-04 12:08PM</time></b><div><p>I have installed Arch Linux on a Microsoft Surface Book 3 to use as my &ldquo;focus&rdquo; machine. This page outlines some things I&rsquo;ve had to install and tweak.</p><p>Most everything <a href=https://github.com/linux-surface/linux-surface/wiki/Supported-Devices-and-Features#surface-books-and-surface-laptop-studio>works out of the box</a> except the cameras. Suspend (which works inconsistently) also eats up 20%+ of the battery life overnight.</p><p>This is <em>not</em> a recommended laptop for running Linux.</p><h3 id=visual-studio-code-hangs-on-launch>Visual Studio Code hangs on launch</h3><p>Had <a href=https://github.com/microsoft/vscode/issues/188397#issuecomment-2033053045>this issue</a>.</p><p>Work around add to ~/.vscode-oss/argv.json</p><pre tabindex=0><code>        &#34;password-store&#34;: &#34;basic&#34;
</code></pre><h3 id=toshy---mac-key-bindings>Toshy - Mac key bindings</h3><p>Installed <a href=https://github.com/RedBearAK/toshy>Toshy</a> because apparently it works better with Wayland.</p><p>Install <a href=https://github.com/xremap/xremap-gnome>xremap-gnome</a> for this to work on Wayland.</p><h3 id=ssh-agent>SSH Agent</h3><p>Add this to ~/.bashrc</p><pre tabindex=0><code># ssh-agent modified from: https://wiki.archlinux.org/title/SSH_keys#ssh-agent
if ! pgrep -u &#34;$USER&#34; ssh-agent &gt; /dev/null; then
    ssh-agent &gt; &#34;$XDG_RUNTIME_DIR/ssh-agent.env&#34;
fi
if [[ ! -f &#34;$SSH_AUTH_SOCK&#34; ]]; then
    source &#34;$XDG_RUNTIME_DIR/ssh-agent.env&#34; &gt;/dev/null
fi
</code></pre><p>Realized that the timeout is set to 1 hour with the &ldquo;-t 1h&rdquo; flag. I removed this since it was annoying.</p><h3 id=jetbrains-mono-apple-and-microsoft-fonts>Jetbrains Mono, Apple and Microsoft fonts</h3><p>Arch has this</p><pre tabindex=0><code>sudo pacman -S ttf-jetbrains-mono apple-fonts ttf-ms-win11-auto
</code></pre><p>Set the default for Visual Studio Code: <a href=https://stackoverflow.com/questions/59776906/how-do-i-change-vs-code-settings-to-use-jetbrains-mono-font>https://stackoverflow.com/questions/59776906/how-do-i-change-vs-code-settings-to-use-jetbrains-mono-font</a></p><h3 id=avahi>Avahi</h3><p>Install</p><pre tabindex=0><code>sudo pacman -S avahi nss-mdns
</code></pre><p>Enable and start</p><pre tabindex=0><code>sudo systemctl enable avahi-daemon.service
sudo systemctl start avahi-daemon.service
</code></pre><p>Enable hostname resolution. Modify line in /etc/nsswitch.conf</p><pre tabindex=0><code>hosts: mymachines mdns4_minimal [NOTFOUND=return] resolve [!UNAVAIL=return] files myhostname dns
</code></pre><h3 id=brother-hl-3170cdw-printer>Brother HL-3170CDW printer</h3><p>Install CUPS</p><pre tabindex=0><code>sudo pacman -S cups
systemctl enable cups.service
systemctl restart cups.service
systemctl status cups.service
</code></pre><p>Install driver</p><pre tabindex=0><code>yay -S brother-hl3170cdw
</code></pre><p>Add printer via CUPS Administration http://localhost:631/admin</p><h3 id=other>Other</h3><pre tabindex=0><code>chromium
code
freetube
git
go
hugo
jq
rust
sudo
vim
</code></pre><h2 id=unresolved-issues>Unresolved issues</h2><h3 id=i915-000000020-drm-error-link-training-unsuccessful>i915 0000:00:02.0: [drm] <em>ERROR</em> Link Training Unsuccessful</h3><p>dmesg output:</p><pre tabindex=0><code>[  861.301517] i915 0000:00:02.0: [drm] *ERROR* Link Training Unsuccessful
</code></pre><p>Similar to: <a href=https://github.com/NixOS/nixpkgs/issues/36392>https://github.com/NixOS/nixpkgs/issues/36392</a></p><p>Appears to be an issue with the dock and using a USBC to Display Port cable.</p><p>.. Switching from Gnome (Wayland) to Gnome Classic (X11) has resolved some annoying suspend issues.</p><h3 id=suspend-is-inconsistent>Suspend is inconsistent</h3><p>Tracking the issue: <a href=https://github.com/linux-surface/linux-surface/issues/1412>https://github.com/linux-surface/linux-surface/issues/1412</a></p></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/posts/2024-03-13-1710365831/>Tweeting images with Golang</a></li><li><a href=/posts/2022-07-24-1658648241/>Litecoin (LTC) - MimbleWimble transactions using Regtest network</a></li><li><a href=/posts/2022-05-15-1652658630/>First post</a></li></ul></div></div></aside><footer><p>&copy; 2024 <a href=https://julianyap.com/><b>Julian Yap</b></a>.
<a href=https://github.com/jyap808><b>GitHub</b></a>.
<a href=https://twitter.com/jyap><b>Twitter</b></a>.</p></footer></body></html>