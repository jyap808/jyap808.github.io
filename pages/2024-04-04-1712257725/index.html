<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Arch Linux - Surface Book 3 | Wilderness Downtown</title>
<link rel=canonical href=https://julianyap.com/pages/2024-04-04-1712257725/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://julianyap.com/pages/2024-04-04-1712257725/"><meta property="og:site_name" content="Wilderness Downtown"><meta property="og:title" content="Arch Linux - Surface Book 3"><meta property="og:description" content="I have installed Arch Linux on a Microsoft Surface Book 3 to use as my “focus” machine. This page outlines some things I’ve had to install and tweak.
Most everything works out of the box except the cameras. Suspend (which works inconsistently) also eats up 20%+ of the battery life overnight.
This is not a recommended laptop for running Linux.
Visual Studio Code hangs on launch Had this issue.
Work around add to ~/."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="pages"><meta property="article:published_time" content="2024-04-04T12:08:45-07:00"><meta property="article:modified_time" content="2024-04-04T12:08:45-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Arch Linux - Surface Book 3"><meta name=twitter:description content="I have installed Arch Linux on a Microsoft Surface Book 3 to use as my “focus” machine. This page outlines some things I’ve had to install and tweak.
Most everything works out of the box except the cameras. Suspend (which works inconsistently) also eats up 20%+ of the battery life overnight.
This is not a recommended laptop for running Linux.
Visual Studio Code hangs on launch Had this issue.
Work around add to ~/."><link rel=stylesheet href=https://julianyap.com/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://julianyap.com/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><header id=header><a href=https://julianyap.com/><div id=title><h1>Wilderness Downtown</h1></div></a><div id=nav><ul><li class=icon><a href=# aria-label=Menu><i class="fas fa-bars fa-2x" aria-hidden=true></i></a></li><li><a href=/posts>Posts</a></li><li><a href=/pages>Pages</a></li><li><a href=/about>About</a></li></ul></div></header><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class=content itemprop=articleBody><p>I have installed Arch Linux on a Microsoft Surface Book 3 to use as my &ldquo;focus&rdquo; machine. This page outlines some things I&rsquo;ve had to install and tweak.</p><p>Most everything <a href=https://github.com/linux-surface/linux-surface/wiki/Supported-Devices-and-Features#surface-books-and-surface-laptop-studio>works out of the box</a> except the cameras. Suspend (which works inconsistently) also eats up 20%+ of the battery life overnight.</p><p>This is <em>not</em> a recommended laptop for running Linux.</p><h3 id=visual-studio-code-hangs-on-launch>Visual Studio Code hangs on launch</h3><p>Had <a href=https://github.com/microsoft/vscode/issues/188397#issuecomment-2033053045>this issue</a>.</p><p>Work around add to ~/.vscode-oss/argv.json</p><pre tabindex=0><code>        &#34;password-store&#34;: &#34;basic&#34;
</code></pre><h3 id=toshy---mac-key-bindings>Toshy - Mac key bindings</h3><p>Installed <a href=https://github.com/RedBearAK/toshy>Toshy</a> because apparently it works better with Wayland.</p><p>Install <a href=https://github.com/xremap/xremap-gnome>xremap-gnome</a> for this to work on Wayland.</p><h3 id=ssh-agent>SSH Agent</h3><p>Add this to ~/.bashrc</p><pre tabindex=0><code># ssh-agent modified from: https://wiki.archlinux.org/title/SSH_keys#ssh-agent
if ! pgrep -u &#34;$USER&#34; ssh-agent &gt; /dev/null; then
    ssh-agent &gt; &#34;$XDG_RUNTIME_DIR/ssh-agent.env&#34;
fi
if [[ ! -f &#34;$SSH_AUTH_SOCK&#34; ]]; then
    source &#34;$XDG_RUNTIME_DIR/ssh-agent.env&#34; &gt;/dev/null
fi
</code></pre><p>Realized that the timeout is set to 1 hour with the &ldquo;-t 1h&rdquo; flag. I removed this since it was annoying.</p><h3 id=jetbrains-mono-apple-and-microsoft-fonts>Jetbrains Mono, Apple and Microsoft fonts</h3><p>Arch has this</p><pre tabindex=0><code>sudo pacman -S ttf-jetbrains-mono apple-fonts ttf-ms-win11-auto
</code></pre><p>Set the default for Visual Studio Code: <a href=https://stackoverflow.com/questions/59776906/how-do-i-change-vs-code-settings-to-use-jetbrains-mono-font>https://stackoverflow.com/questions/59776906/how-do-i-change-vs-code-settings-to-use-jetbrains-mono-font</a></p><h3 id=avahi>Avahi</h3><p>Install</p><pre tabindex=0><code>sudo pacman -S avahi nss-mdns
</code></pre><p>Enable and start</p><pre tabindex=0><code>sudo systemctl enable avahi-daemon.service
sudo systemctl start avahi-daemon.service
</code></pre><p>Enable hostname resolution. Modify line in /etc/nsswitch.conf</p><pre tabindex=0><code>hosts: mymachines mdns4_minimal [NOTFOUND=return] resolve [!UNAVAIL=return] files myhostname dns
</code></pre><h3 id=brother-hl-3170cdw-printer>Brother HL-3170CDW printer</h3><p>Install CUPS</p><pre tabindex=0><code>sudo pacman -S cups
systemctl enable cups.service
systemctl restart cups.service
systemctl status cups.service
</code></pre><p>Install driver</p><pre tabindex=0><code>yay -S brother-hl3170cdw
</code></pre><p>Add printer via CUPS Administration http://localhost:631/admin</p><h3 id=other>Other</h3><pre tabindex=0><code>chromium
code
freetube
git
go
hugo
jq
rust
sudo
vim
</code></pre><h2 id=unresolved-issues>Unresolved issues</h2><h3 id=i915-000000020-drm-error-link-training-unsuccessful>i915 0000:00:02.0: [drm] <em>ERROR</em> Link Training Unsuccessful</h3><p>dmesg output:</p><pre tabindex=0><code>[  861.301517] i915 0000:00:02.0: [drm] *ERROR* Link Training Unsuccessful
</code></pre><p>Similar to: <a href=https://github.com/NixOS/nixpkgs/issues/36392>https://github.com/NixOS/nixpkgs/issues/36392</a></p><p>Appears to be an issue with the dock and using a USBC to Display Port cable.</p><p>.. Switching from Gnome (Wayland) to Gnome Classic (X11) has resolved some annoying suspend issues.</p><h3 id=suspend-is-inconsistent>Suspend is inconsistent</h3><p>Tracking the issue: <a href=https://github.com/linux-surface/linux-surface/issues/1412>https://github.com/linux-surface/linux-surface/issues/1412</a></p></div></article><footer id=footer><div class=footer-left>Copyright &copy; 2024 Julian Yap</div><div class=footer-right><nav><ul><li><a href=/posts>Posts</a></li><li><a href=/pages>Pages</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>